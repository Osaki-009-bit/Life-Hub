<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life-Hub Schedule PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .active-day { background-color: #2563eb !important; color: white !important; transform: scale(1.05); font-weight: 900; }
        .game-tag { background: linear-gradient(90deg, #ef4444, #f97316); }
        input, select { height: 50px; font-size: 14px !important; }
        .tab-active { border-bottom: 4px solid #2563eb; color: #2563eb; }
    </style>
</head>
<body class="bg-gray-100 pb-32 text-left">

    <div id="urgentAlert" class="hidden bg-orange-500 text-white p-4 text-center font-black text-xs uppercase tracking-widest sticky top-0 z-50 shadow-lg"></div>

    <div class="bg-white shadow-xl px-5 pt-6 pb-4 rounded-b-[2.5rem]">
        <h1 class="text-xl font-[900] italic tracking-tighter text-blue-900 uppercase mb-4 text-center">Life-Hub <span class="text-blue-500">PRO SCHEDULE</span></h1>
        
        <div class="flex justify-between gap-1 overflow-x-auto pb-2 no-scrollbar">
            <button onclick="setDay(1)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="1">å‘¨ä¸€</button>
            <button onclick="setDay(2)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="2">å‘¨äºŒ</button>
            <button onclick="setDay(3)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="3">å‘¨ä¸‰</button>
            <button onclick="setDay(4)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="4">å‘¨å››</button>
            <button onclick="setDay(5)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="5">å‘¨äº”</button>
            <button onclick="setDay(6)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="6">å‘¨å…­</button>
            <button onclick="setDay(0)" class="day-btn flex-1 min-w-[45px] py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="0">å‘¨æ—¥</button>
        </div>
    </div>

    <div class="mx-5 mt-6 p-6 bg-white rounded-[2.5rem] shadow-2xl space-y-4 border border-gray-50">
        <div class="flex border-b border-gray-100 mb-2">
            <button id="tabRegular" onclick="switchMode('regular')" class="flex-1 py-2 text-[10px] font-black tab-active">å¸¸è§„å‘¨è¯¾</button>
            <button id="tabSpecial" onclick="switchMode('special')" class="flex-1 py-2 text-[10px] font-black text-gray-400">æ¯”èµ›/å˜åŠ¨</button>
        </div>

        <input type="text" id="courseName" placeholder="è¯¾ç¨‹/æ¯”èµ›åç§°" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none focus:border-blue-500">

        <div id="dateArea" class="hidden">
            <label class="text-[9px] font-black text-gray-400 ml-1 uppercase">ç‰¹å®šæ—¥æœŸ</label>
            <input type="date" id="specialDate" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <div class="grid grid-cols-2 gap-3">
            <div class="space-y-1">
                <label class="text-[9px] font-black text-gray-400 ml-1 uppercase">å¼€å§‹</label>
                <input type="time" id="startTime" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
            </div>
            <div class="space-y-1">
                <label class="text-[9px] font-black text-gray-400 ml-1 uppercase">ç»“æŸ</label>
                <input type="time" id="endTime" class="w-full p-4 border-2 border-gray-100 rounded-xl bg-gray-50 text-sm font-black outline-none">
            </div>
        </div>

        <div id="regularInfo" class="grid grid-cols-2 gap-3">
            <input type="number" id="totalSessions" placeholder="æ€»è¯¾æ—¶" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
            <input type="text" id="dateRange" placeholder="å¦‚: 1æœˆ-6æœˆ" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <input type="text" id="location" placeholder="åœ°ç‚¹ (e.g. Center Pool)" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">

        <button onclick="saveEntry()" class="w-full bg-blue-600 text-white h-16 rounded-2xl font-black text-sm shadow-xl active:scale-95 transition-all uppercase tracking-widest">Commit to Ledger</button>
    </div>

    <div id="scheduleList" class="px-5 mt-6 space-y-4 pb-12"></div>

    <div class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-xl border-t border-gray-100 flex justify-around p-5 z-40">
        <a href="price.html" class="flex flex-col items-center text-gray-400">
            <span class="text-[10px] font-black uppercase tracking-widest">Analytics</span>
        </a>
        <a href="schedule.html" class="flex flex-col items-center text-blue-600">
            <div class="w-1.5 h-1.5 bg-blue-600 rounded-full mb-1"></div>
            <span class="text-[10px] font-black uppercase tracking-widest">Schedule</span>
        </a>
    </div>

    <script>
        let entries = JSON.parse(localStorage.getItem('lh_schedule_pro_v1') || '[]');
        let currentDay = new Date().getDay();
        let currentMode = 'regular';

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('tabRegular').className = mode === 'regular' ? 'flex-1 py-2 text-[10px] font-black tab-active' : 'flex-1 py-2 text-[10px] font-black text-gray-400';
            document.getElementById('tabSpecial').className = mode === 'special' ? 'flex-1 py-2 text-[10px] font-black tab-active' : 'flex-1 py-2 text-[10px] font-black text-gray-400';
            document.getElementById('dateArea').classList.toggle('hidden', mode === 'regular');
            document.getElementById('regularInfo').classList.toggle('hidden', mode === 'special');
        }

        function setDay(day) {
            currentDay = day;
            renderEntries();
        }

        function saveEntry() {
            const entry = {
                id: Date.now(),
                mode: currentMode,
                name: document.getElementById('courseName').value,
                start: document.getElementById('startTime').value,
                end: document.getElementById('endTime').value,
                loc: document.getElementById('location').value,
                day: currentDay,
                date: document.getElementById('specialDate').value,
                total: document.getElementById('totalSessions').value,
                range: document.getElementById('dateRange').value
            };

            if(!entry.name || !entry.start) return alert("ç»ç†ï¼Œæ ¸å¿ƒä¿¡æ¯ä¸èƒ½ä¸ºç©ºï¼");
            entries.push(entry);
            localStorage.setItem('lh_schedule_pro_v1', JSON.stringify(entries));
            renderEntries();
        }

        function renderEntries() {
            const listDiv = document.getElementById('scheduleList');
            const btns = document.querySelectorAll('.day-btn');
            listDiv.innerHTML = '';
            
            btns.forEach(btn => btn.classList.toggle('active-day', parseInt(btn.dataset.day) === currentDay));

            const now = new Date();
            const todayStr = now.toISOString().split('T')[0];
            const nowTime = now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0');

            // ç­›é€‰ï¼šå¦‚æœæ˜¯å¸¸è§„è¯¾çœ‹å‘¨å‡ ï¼Œå¦‚æœæ˜¯æ¯”èµ›çœ‹æ—¥æœŸæ˜¯å¦æ˜¯ä»Šå¤©ï¼ˆæˆ–æ˜¯å…³è”æ˜¾ç¤ºï¼‰
            let todays = entries.filter(e => {
                if(e.mode === 'regular') return e.day === currentDay;
                if(e.mode === 'special') return e.date === todayStr || (new Date(e.date).getDay() === currentDay);
                return false;
            }).sort((a,b) => a.start.localeCompare(b.start));

            todays.forEach(e => {
                const isGame = e.mode === 'special';
                const isOngoing = nowTime >= e.start && nowTime <= e.end;
                const isPast = nowTime > e.end;

                // æŸ¥æ‰¾è¯¥è¯¾ç¨‹ç›¸å…³çš„æ¯”èµ›/å˜åŠ¨
                let related = entries.filter(r => r.mode === 'special' && r.name.includes(e.name) && r.id !== e.id);

                listDiv.innerHTML += `
                    <div class="bg-white p-6 rounded-[2rem] shadow-xl border-l-8 ${isGame ? 'border-orange-500' : 'border-blue-500'} ${isPast ? 'opacity-40' : ''} ${isOngoing ? 'ring-4 ring-blue-100' : ''}">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-lg font-black text-gray-900">${e.name}</span>
                                    ${isGame ? '<span class="game-tag text-[8px] text-white px-2 py-0.5 rounded-full font-black">GAME/EVENT</span>' : ''}
                                </div>
                                <p class="text-sm font-black text-blue-600">${e.start} â€” ${e.end}</p>
                                <p class="text-[10px] font-bold text-gray-400 mt-2">ğŸ“ ${e.loc}</p>
                                ${e.range ? `<p class="text-[9px] font-black text-gray-300 mt-1 uppercase">ğŸ—“å‘¨æœŸ: ${e.range} | ${e.total}èŠ‚</p>` : ''}
                            </div>
                            <button onclick="deleteEntry(${e.id})" class="text-gray-200 text-lg">âœ•</button>
                        </div>
                        
                        ${related.length > 0 ? `
                        <div class="mt-4 pt-3 border-t border-dashed border-gray-100">
                            <p class="text-[9px] font-black text-orange-400 mb-2 uppercase">å…³è”å˜åŠ¨/æ¯”èµ›:</p>
                            ${related.map(r => `
                                <div class="flex justify-between text-[9px] font-bold text-gray-500 bg-gray-50 p-2 rounded-lg mb-1">
                                    <span>ğŸ“… ${r.date}</span>
                                    <span>${r.start} @ ${r.loc}</span>
                                </div>
                            `).join('')}
                        </div>` : ''}
                    </div>
                `;
            });
            updateUrgentAlert();
        }

        function deleteEntry(id) {
            if(confirm("ç»ç†ï¼Œç¡®è®¤åˆ é™¤æ­¤é¡¹ï¼Ÿ")) {
                entries = entries.filter(e => e.id !== id);
                localStorage.setItem('lh_schedule_pro_v1', JSON.stringify(entries));
                renderEntries();
            }
        }

        function updateUrgentAlert() {
            const bar = document.getElementById('urgentAlert');
            const now = new Date();
            const todayStr = now.toISOString().split('T')[0];
            
            let upcoming = entries.filter(e => {
                if(e.mode === 'special' && e.date === todayStr) return true;
                if(e.mode === 'regular' && e.day === now.getDay()) return true;
                return false;
            });

            let found = false;
            for(let e of upcoming) {
                let [h, m] = e.start.split(':').map(Number);
                let start = new Date(); start.setHours(h, m, 0);
                let diff = (start - now) / 1000 / 60;
                if(diff > 0 && diff <= 45) {
                    bar.innerHTML = `âš ï¸ ç´§æ€¥: ${e.name} å°†åœ¨ ${Math.floor(diff)} åˆ†é’Ÿåå¼€å§‹ (${e.loc})`;
                    bar.classList.remove('hidden');
                    found = true; break;
                }
            }
            if(!found) bar.classList.add('hidden');
        }

        setInterval(renderEntries, 60000);
        renderEntries();
    </script>
</body>
</html>
