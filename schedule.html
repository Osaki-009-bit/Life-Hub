<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life-Hub Schedule ARCHIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .active-day { background-color: #2563eb !important; color: white !important; transform: scale(1.05); font-weight: 900; }
        .has-regular::after { content: ''; display: block; width: 4px; height: 4px; background: #2563eb; margin: 2px auto; border-radius: 50%; }
        .has-game::after { content: ''; display: block; width: 4px; height: 4px; background: #ef4444; margin: 2px auto; border-radius: 50%; }
        .tab-active { border-bottom: 4px solid #2563eb; color: #2563eb; }
        input, select { height: 50px; font-size: 14px !important; }
    </style>
</head>
<body class="bg-gray-100 pb-32">

    <div class="bg-white shadow-xl px-5 pt-6 pb-4 rounded-b-[2.5rem]">
        <h1 class="text-xl font-[900] italic tracking-tighter text-blue-900 uppercase mb-4 text-center">Life-Hub <span class="text-blue-500">ARCHIVE</span></h1>
        
        <div class="relative mb-6">
            <label class="text-[10px] font-black text-blue-600 ml-1 uppercase">è¯¾ç¨‹å¿«é€Ÿç´¢å¼• / æ¡£æ¡ˆæ£€ç´¢</label>
            <input type="text" id="courseSearch" list="courseHistory" placeholder="è¾“å…¥è¯¾ç¨‹åç§° (å¦‚: ç¯®çƒ)" 
                   class="w-full p-4 border-2 border-blue-100 rounded-2xl bg-blue-50 text-base font-black outline-none focus:border-blue-500"
                   onchange="loadCourseArchive(this.value)">
            <datalist id="courseHistory"></datalist>
        </div>

        <div class="mb-4 overflow-hidden">
            <div id="calendarGrid" class="grid grid-cols-7 gap-1 text-center text-[10px] font-bold text-gray-400 uppercase">
                <div>ä¸€</div><div>äºŒ</div><div>ä¸‰</div><div>å››</div><div>äº”</div><div>å…­</div><div>æ—¥</div>
            </div>
            <div id="calendarDates" class="grid grid-cols-7 gap-1 mt-2"></div>
        </div>

        <div class="flex justify-between gap-1 overflow-x-auto no-scrollbar">
            <button onclick="setDay(1)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="1">å‘¨ä¸€</button>
            <button onclick="setDay(2)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="2">å‘¨äºŒ</button>
            <button onclick="setDay(3)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="3">å‘¨ä¸‰</button>
            <button onclick="setDay(4)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="4">å‘¨å››</button>
            <button onclick="setDay(5)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="5">å‘¨äº”</button>
            <button onclick="setDay(6)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="6">å‘¨å…­</button>
            <button onclick="setDay(0)" class="day-btn flex-1 py-3 bg-gray-50 rounded-xl text-[10px] font-black transition-all" data-day="0">å‘¨æ—¥</button>
        </div>
    </div>

    <div class="mx-5 mt-6 p-6 bg-white rounded-[2.5rem] shadow-2xl space-y-4">
        <div class="flex border-b border-gray-100 mb-2">
            <button id="tabRegular" onclick="switchMode('regular')" class="flex-1 py-2 text-[10px] font-black tab-active">å¸¸è§„å‘¨è¯¾</button>
            <button id="tabSpecial" onclick="switchMode('special')" class="flex-1 py-2 text-[10px] font-black text-gray-400">æ¯”èµ›å˜åŠ¨</button>
        </div>

        <div id="dateArea" class="hidden">
            <input type="date" id="specialDate" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <div class="grid grid-cols-2 gap-3">
            <input type="time" id="startTime" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
            <input type="time" id="endTime" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <div id="regularInfo" class="grid grid-cols-2 gap-3">
            <input type="number" id="totalSessions" placeholder="æ€»è¯¾æ—¶" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
            <input type="text" id="dateRange" placeholder="å‡ æœˆåˆ°å‡ æœˆ" class="p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <input type="text" id="location" placeholder="åœ°ç‚¹" class="w-full p-4 border-2 border-gray-50 rounded-xl bg-gray-50 text-sm font-black outline-none">

        <button onclick="saveEntry()" class="w-full bg-blue-600 text-white h-16 rounded-2xl font-black text-sm shadow-xl active:scale-95 transition-all uppercase tracking-widest">Commit Course</button>
    </div>

    <div id="scheduleList" class="px-5 mt-6 space-y-4 pb-12"></div>

    <div class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-xl border-t border-gray-100 flex justify-around p-5 z-40">
        <a href="price.html" class="flex flex-col items-center text-gray-400">
            <span class="text-[10px] font-black uppercase tracking-widest">Analytics</span>
        </a>
        <a href="schedule.html" class="flex flex-col items-center text-blue-600">
            <div class="w-1.5 h-1.5 bg-blue-600 rounded-full mb-1"></div>
            <span class="text-[10px] font-black uppercase tracking-widest">Schedule</span>
        </a>
    </div>

    <script>
        let entries = JSON.parse(localStorage.getItem('lh_schedule_pro_v2') || '[]');
        let currentDay = new Date().getDay();
        let currentMode = 'regular';

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('tabRegular').className = mode === 'regular' ? 'flex-1 py-2 text-[10px] font-black tab-active' : 'flex-1 py-2 text-[10px] font-black text-gray-400';
            document.getElementById('tabSpecial').className = mode === 'special' ? 'flex-1 py-2 text-[10px] font-black tab-active' : 'flex-1 py-2 text-[10px] font-black text-gray-400';
            document.getElementById('dateArea').classList.toggle('hidden', mode === 'regular');
            document.getElementById('regularInfo').classList.toggle('hidden', mode === 'special');
        }

        function setDay(day) { currentDay = day; render(); }

        function saveEntry() {
            const name = document.getElementById('courseSearch').value;
            if(!name) return alert("ç»ç†ï¼Œè¯·å…ˆè¾“å…¥è¯¾ç¨‹åç§°ä½œä¸ºç´¢å¼•ï¼");
            
            const entry = {
                id: Date.now(),
                mode: currentMode,
                name: name,
                start: document.getElementById('startTime').value,
                end: document.getElementById('endTime').value,
                loc: document.getElementById('location').value,
                day: currentDay,
                date: document.getElementById('specialDate').value || new Date().toISOString().split('T')[0],
                total: document.getElementById('totalSessions').value,
                range: document.getElementById('dateRange').value
            };

            entries.push(entry);
            localStorage.setItem('lh_schedule_pro_v2', JSON.stringify(entries));
            render();
        }

        // ç»ç†è¦æ±‚çš„ï¼šè°ƒæ¡£åŠŸèƒ½
        function loadCourseArchive(courseName) {
            const archive = entries.find(e => e.name === courseName && e.mode === 'regular');
            if(archive) {
                document.getElementById('startTime').value = archive.start;
                document.getElementById('endTime').value = archive.end;
                document.getElementById('location').value = archive.loc;
                document.getElementById('totalSessions').value = archive.total;
                document.getElementById('dateRange').value = archive.range;
                currentDay = archive.day;
                render();
            }
        }

        function render() {
            const listDiv = document.getElementById('scheduleList');
            const historyList = document.getElementById('courseHistory');
            const datesDiv = document.getElementById('calendarDates');
            listDiv.innerHTML = '';
            historyList.innerHTML = '';
            datesDiv.innerHTML = '';

            // æ›´æ–°å†å²ä¸‹æ‹‰èœå•
            const names = [...new Set(entries.map(e => e.name))];
            names.forEach(n => historyList.innerHTML += `<option value="${n}">`);

            // æ›´æ–°è¿·ä½ æ—¥å† (æ˜¾ç¤ºæœ¬å‘¨/æœ¬æœˆç¤ºæ„)
            const now = new Date();
            for(let i=-2; i<5; i++) {
                let d = new Date(); d.setDate(now.getDate() + i);
                let dStr = d.toISOString().split('T')[0];
                let hasReg = entries.some(e => e.mode === 'regular' && e.day === d.getDay());
                let hasGame = entries.some(e => e.mode === 'special' && e.date === dStr);
                
                let dotClass = "";
                if(hasGame) dotClass = "has-game";
                else if(hasReg) dotClass = "has-regular";

                datesDiv.innerHTML += `
                    <div class="text-[12px] font-black p-2 ${d.getDate() === now.getDate() ? 'bg-blue-100 rounded-lg text-blue-600' : 'text-gray-900'} ${dotClass}">
                        ${d.getDate()}
                    </div>`;
            }

            // æ›´æ–°å‘¨æŒ‰é’®
            document.querySelectorAll('.day-btn').forEach(btn => btn.classList.toggle('active-day', parseInt(btn.dataset.day) === currentDay));

            // æ›´æ–°åˆ—è¡¨
            const todayStr = now.toISOString().split('T')[0];
            let filtered = entries.filter(e => {
                const search = document.getElementById('courseSearch').value;
                if(search) return e.name === search; // å¦‚æœæœäº†ï¼Œå°±æ˜¾ç¤ºè¯¥è¯¾æ‰€æœ‰æ¡£æ¡ˆ
                return e.day === currentDay || e.date === todayStr; // å¦åˆ™æ˜¾ç¤ºä»Šæ—¥/å½“å‘¨
            }).sort((a,b) => a.start.localeCompare(b.start));

            filtered.forEach(e => {
                listDiv.innerHTML += `
                    <div class="bg-white p-6 rounded-[2rem] shadow-xl border-l-8 ${e.mode === 'special' ? 'border-red-500' : 'border-blue-500'}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-lg font-[900] text-gray-900 uppercase">${e.name}</span>
                                    <span class="${e.mode === 'special' ? 'bg-red-500' : 'bg-blue-600'} text-white text-[8px] px-2 py-0.5 rounded-full font-black">${e.mode === 'special' ? 'GAME' : 'REGULAR'}</span>
                                </div>
                                <p class="text-[11px] font-black text-gray-900">ğŸ—“ ${e.mode === 'special' ? e.date : 'æ¯å‘¨' + ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][e.day]} | ${e.start} - ${e.end}</p>
                                <p class="text-[10px] font-bold text-gray-400 mt-2">ğŸ“ ${e.loc}</p>
                                ${e.total ? `<div class="mt-3 flex gap-2"><span class="bg-gray-100 text-[9px] font-black px-3 py-1 rounded-lg uppercase">Total: ${e.total}èŠ‚</span><span class="bg-gray-100 text-[9px] font-black px-3 py-1 rounded-lg uppercase">Range: ${e.range}</span></div>` : ''}
                            </div>
                            <button onclick="deleteEntry(${e.id})" class="text-gray-200">âœ•</button>
                        </div>
                    </div>
                `;
            });
        }

        function deleteEntry(id) {
            if(confirm("ç¡®å®šåˆ é™¤æ­¤é¡¹æ¡£æ¡ˆï¼Ÿ")) {
                entries = entries.filter(e => e.id !== id);
                localStorage.setItem('lh_schedule_pro_v2', JSON.stringify(entries));
                render();
            }
        }

        render();
    </script>
</body>
</html>
