<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life-Hub Schedule MULTI-DATE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .date-selected { background-color: #2563eb !important; color: white !important; border-radius: 12px; font-weight: 900; }
        .has-event::after { content: ''; display: block; width: 4px; height: 4px; background: #cbd5e1; margin: 2px auto; border-radius: 50%; }
        .modal-active { display: flex !important; }
        input, select { height: 55px; font-size: 15px !important; font-weight: 900 !important; }
    </style>
</head>
<body class="bg-gray-100 pb-32">

    <div class="bg-white shadow-xl px-6 pt-8 pb-6 rounded-b-[3rem]">
        <h1 class="text-2xl font-[900] italic tracking-tighter text-blue-900 uppercase mb-6 text-center">Life-Hub <span class="text-blue-500">SCHEDULE</span></h1>
        <input type="text" id="courseInput" list="courseHistory" placeholder="è¾“å…¥è¯¾ç¨‹å (å¦‚: ç¯®çƒè¯¾)" 
               class="w-full p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-base font-black outline-none focus:border-blue-500">
        <datalist id="courseHistory"></datalist>
    </div>

    <div class="mx-6 mt-6 p-7 bg-white rounded-[2.8rem] shadow-2xl space-y-4">
        <div class="flex border-b border-gray-100 mb-2">
            <div class="flex-1 py-3 text-[11px] font-black border-b-4 border-blue-600 text-blue-600 text-center uppercase tracking-widest">å½•å…¥æ˜ç»†</div>
        </div>

        <button onclick="openPicker()" class="w-full py-4 bg-blue-50 border-2 border-blue-100 rounded-2xl flex justify-between items-center px-5 active:scale-95 transition-all">
            <span class="text-blue-600 font-black text-sm">ğŸ“… ç‚¹å‡»æ—¥å†å¤šé€‰æ—¥æœŸ (æŸæœˆæŸæ—¥)</span>
            <span id="selectedCount" class="bg-blue-600 text-white text-[10px] px-2 py-1 rounded-full">å·²é€‰ 0 å¤©</span>
        </button>

        <div class="grid grid-cols-2 gap-3">
            <input type="time" id="startTime" class="p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-sm font-black outline-none">
            <input type="time" id="endTime" class="p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-sm font-black outline-none">
        </div>

        <div class="grid grid-cols-2 gap-3">
            <div class="relative flex items-center">
                <input type="number" id="sessions" placeholder="æ€»è¯¾æ—¶" class="w-full p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-sm font-black outline-none">
                <span class="absolute right-4 text-[11px] font-black text-gray-300">èŠ‚</span>
            </div>
            <div class="relative flex items-center">
                <input type="text" id="range" placeholder="å‡ æœˆåˆ°å‡ æœˆ" class="w-full p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-sm font-black outline-none">
                <span class="absolute right-4 text-[11px] font-black text-gray-300">æœˆ</span>
            </div>
        </div>

        <input type="text" id="loc" placeholder="åœ°ç‚¹ (e.g. ä½“è‚²é¦†)" class="w-full p-4 border-2 border-gray-50 rounded-2xl bg-gray-50 text-sm font-black outline-none">

        <button onclick="saveBulk()" class="w-full bg-blue-600 text-white h-20 rounded-[2rem] font-[900] text-lg shadow-2xl active:scale-[0.96] transition-all uppercase tracking-widest">Commit Course</button>
    </div>

    <div id="projectContainer" class="px-6 mt-8 space-y-4"></div>

    <div id="pickerModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex-col justify-end">
        <div class="bg-white rounded-t-[3rem] p-8 space-y-6 max-h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-center border-b pb-4">
                <div>
                    <h2 class="text-xl font-[900] text-gray-900 uppercase">é€‰æ‹©ä¸Šè¯¾æ—¥æœŸ</h2>
                    <p class="text-[10px] font-black text-gray-400">æ”¯æŒè·¨æœˆå¤šé€‰ï¼Œç‚¹å‡»æ—¥æœŸå³å¯é€‰ä¸­</p>
                </div>
                <button onclick="closePicker()" class="bg-gray-100 text-gray-400 p-2 rounded-full px-4 font-black">å®Œæˆ</button>
            </div>
            
            <div id="pickerCalendar" class="grid grid-cols-7 gap-1 text-center text-[11px] font-black">
                </div>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('lh_multidate_v1') || '[]');
        let tempDates = []; // ä¸´æ—¶å­˜å‚¨é€‰ä¸­çš„æ—¥æœŸ

        function openPicker() {
            document.getElementById('pickerModal').classList.add('modal-active');
            renderPickerCalendar();
        }

        function closePicker() {
            document.getElementById('pickerModal').classList.remove('modal-active');
            document.getElementById('selectedCount').innerText = `å·²é€‰ ${tempDates.length} å¤©`;
        }

        function renderPickerCalendar() {
            const grid = document.getElementById('pickerCalendar');
            grid.innerHTML = '<div class="py-2">æ—¥</div><div class="py-2">ä¸€</div><div class="py-2">äºŒ</div><div class="py-2">ä¸‰</div><div class="py-2">å››</div><div class="py-2">äº”</div><div class="py-2">å…­</div>';
            
            const now = new Date();
            const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();

            for(let i = 1; i <= daysInMonth; i++) {
                const dateStr = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${i.toString().padStart(2,'0')}`;
                const btn = document.createElement('button');
                btn.innerText = i;
                btn.className = "py-4 text-gray-400 transition-all";
                if(tempDates.includes(dateStr)) btn.classList.add('date-selected');
                
                btn.onclick = () => {
                    if(tempDates.includes(dateStr)) tempDates = tempDates.filter(d => d !== dateStr);
                    else tempDates.push(dateStr);
                    renderPickerCalendar();
                };
                grid.appendChild(btn);
            }
        }

        function saveBulk() {
            const name = document.getElementById('courseInput').value;
            if(!name || tempDates.length === 0) return alert("ç»ç†ï¼Œè¯·è¾“å…¥è¯¾ç¨‹åå¹¶è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ—¥æœŸï¼");
            
            tempDates.forEach(date => {
                const entry = {
                    id: Date.now() + Math.random(),
                    name, date,
                    start: document.getElementById('startTime').value,
                    end: document.getElementById('endTime').value,
                    loc: document.getElementById('loc').value,
                    total: document.getElementById('sessions').value,
                    range: document.getElementById('range').value
                };
                db.push(entry);
            });

            localStorage.setItem('lh_multidate_v1', JSON.stringify(db));
            tempDates = [];
            document.getElementById('selectedCount').innerText = `å·²é€‰ 0 å¤©`;
            render();
        }

        function render() {
            const container = document.getElementById('projectContainer');
            const history = document.getElementById('courseHistory');
            container.innerHTML = '';
            history.innerHTML = '';

            const projects = [...new Set(db.map(i => i.name))];
            projects.forEach(p => {
                history.innerHTML += `<option value="${p}">`;
                const pData = db.filter(i => i.name === p).sort((a,b) => a.date.localeCompare(b.date));
                
                container.innerHTML += `
                    <div class="bg-white p-7 rounded-[2.5rem] shadow-xl border border-gray-50 space-y-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-[10px] font-black text-blue-600 uppercase tracking-widest mb-1">PROJECT ARCHIVE</p>
                                <h3 class="text-2xl font-[900] text-gray-900 uppercase">${p}</h3>
                            </div>
                            <button onclick="deleteProject('${p}')" class="text-gray-200 text-xl">âœ•</button>
                        </div>
                        
                        <div class="space-y-2 max-h-60 overflow-y-auto pr-2 no-scrollbar">
                            ${pData.map(d => `
                                <div class="bg-gray-50 p-4 rounded-2xl flex justify-between items-center border border-gray-100">
                                    <div class="text-left">
                                        <p class="text-[11px] font-[900] text-gray-800">${d.date} | å‘¨${['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][new Date(d.date).getDay()]}</p>
                                        <p class="text-[10px] font-bold text-gray-400 mt-1 uppercase">ğŸ“ ${d.loc}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-[13px] font-[900] text-blue-600 tracking-tighter">${d.start} - ${d.end}</p>
                                        <button onclick="deleteSingle('${d.id}')" class="text-[8px] font-black text-red-300 uppercase mt-1">Delete</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
        }

        function deleteProject(name) {
            if(confirm("ç¡®å®šåˆ é™¤æ•´ä¸ªé¡¹ç›®ï¼Ÿ")) {
                db = db.filter(i => i.name !== name);
                localStorage.setItem('lh_multidate_v1', JSON.stringify(db));
                render();
            }
        }

        function deleteSingle(id) {
            db = db.filter(i => i.id.toString() !== id.toString());
            localStorage.setItem('lh_multidate_v1', JSON.stringify(db));
            render();
        }

        render();
    </script>
</body>
</html>
